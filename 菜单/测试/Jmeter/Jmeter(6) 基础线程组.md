## Thread Group基础线程组介绍

[![img](https://img2020.cnblogs.com/blog/1896874/202004/1896874-20200426203502025-133867777.png)](https://img2020.cnblogs.com/blog/1896874/202004/1896874-20200426203502025-133867777.png)

 

### Thread Group的简单理解

- 线程组是一个测试计划的开始点
- 在一个测试计划中的所有元件都必须在某个线程组下
- 线程组决定 Jmeter 执行测试计划的**线程数**

 

### Thread Group提供的主要作用

- 设置线程数
- 设置ramp-up period
- 设置执行测试的次数

 

### Thread Group的独立性

每个线程都会独立的运行测试计划，互不干扰，多个线程用于模仿对服务器的并发访问。

 

# Thread Group线程属性讲解

[![img](https://img2020.cnblogs.com/blog/1896874/202004/1896874-20200426213547291-199087958.png)](https://img2020.cnblogs.com/blog/1896874/202004/1896874-20200426213547291-199087958.png)

 

## 在取样器错误后要执行的动作

**默认：**继续

**建议：**继续

假设一个HTTP Sampler报错了，后面还有其他请求，最好肯定是继续执行下去啦

 

## 线程属性值

设置的线程属性值是**【预期压力值】**

而聚合报告是**【压力测试的实际结果】**

 

## 线程数

- Jmeter java进程下启动的线程，用来**模拟真实用户数**，1线程数 = 1用户数
- windows下，2g的 java内存，1m 的栈空间，最大启动线程数=1000
- Linux下，2g的 java内存，1m 的栈空间，最大启动线程数=2000
- 在Jmeter中，先启动线程，再运行线程，后释放线程**【启动线程并运行，释放线程】**
- **线程数建议不超过1000**

 

## Ramp-Up时间（秒）

- 预期线程组的所有线程从启动-运行-释放的总时间
- ramp up=0时，表示瞬时加压，启动线程的时间无限趋近于0
- **特别注意：**在负载测试的时候，尽量**把ramp up设置大**一些，让性能曲线平缓，容易找到瓶颈点

 

## 循环次数

- 每个线程循环执行的次数，**默认一次【便于理解：线程的迭代次数、重复发起请求的次数】**
- 如果设置为**永远**，那么 jmeter 将以最大的可能去发送请求，以此测试出**最大并发数**

 

## 线程属性值的简单栗子

[![img](https://img2020.cnblogs.com/blog/1896874/202006/1896874-20200620115418069-625445078.png)](https://img2020.cnblogs.com/blog/1896874/202006/1896874-20200620115418069-625445078.png)

**上图：**10s 内启动并运行 10 个线程，一共启动 10 个线程，总共发送 20 个请求（10*2），每秒启动一个线程，然后运行两次**
**

**备注：**如果 ramp-up 时间内，所有线程不能启动运行完的话，时间则会顺延下去

 

## Ramp-up 设置注意事项

#### Ramp-up需要设置足够长的时间来避免在测试刚开始时工作量过大

- 假如需要大量线程的话，不建议设置成0，0 属于瞬时加压**【过小的 ramp-up period 】**
- 如果设置 0，Jmeter 将在**测试****开始时**就启动全部线程并**立即发送请求**，这样很容易让服务器达到饱满状态，且瞬间会增加很大的负载量，容易让服务器超载，这样是不合理的；
- 不合理的原因并不是因为平均压力值过高，而是因为所有线程都在**初始状态时一起并发访问**，从而引起不正常的初始访问峰值，可以通过 Jmeter 的聚合报告看到这种情况

 

#### Ramp-up还必须足够短，保证最后一个线程在第一个线程完成之前开始运行

- 如果 Ramp-up 过大，则会降低访问峰值的负载，即没有达到预期的压力峰值，无法获取准确的服务器最大负载情况**【过大的 ramp-up period 】**
- **具体的表现为：**一些线程还没有启动，初期启动的部分线程已经结束了**【导致实际并发量并会小于预期并发量】**

 

#### 如何确定一个合理的ramp-up period

- 首先，让初始点击率接近平均点击率，前提是确定合理的访问量
- 初始的 ramp-up period = 平均点击率= 总线程/点击率；假如线程数=100，点击率=10次/s，则ramp-up period = 100/10 = 10s

 